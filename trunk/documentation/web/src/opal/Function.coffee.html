<!DOCTYPE html>

<html>
<head>
  <title>Function</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="Array.coffee.html">
                Array.coffee.md
              </a>
            
              
              <a class="source" href="BareObject.coffee.html">
                BareObject.coffee.md
              </a>
            
              
              <a class="source" href="Boolean.coffee.html">
                Boolean.coffee.md
              </a>
            
              
              <a class="source" href="Function.coffee.html">
                Function.coffee.md
              </a>
            
              
              <a class="source" href="Math.coffee.html">
                Math.coffee.md
              </a>
            
              
              <a class="source" href="Maybe.coffee.html">
                Maybe.coffee.md
              </a>
            
              
              <a class="source" href="Nullable.coffee.html">
                Nullable.coffee.md
              </a>
            
              
              <a class="source" href="Number.coffee.html">
                Number.coffee.md
              </a>
            
              
              <a class="source" href="Object.coffee.html">
                Object.coffee.md
              </a>
            
              
              <a class="source" href="Promise.coffee.html">
                Promise.coffee.md
              </a>
            
              
              <a class="source" href="String.coffee.html">
                String.coffee.md
              </a>
            
              
              <a class="source" href="header.coffee.html">
                header.coffee.md
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap for-h1">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1>Function</h1>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">extend</span></span> = (properties) -&gt; Object.extend <span class="keyword">this</span>, properties</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>Basic functions</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function.<span class="function"><span class="title">identity</span></span> = (x) -&gt; x

	Function.<span class="function"><span class="title">constant</span></span> = (constant) -&gt; () -&gt; constant

	Function.<span class="function"><span class="title">arguments</span></span> = (args...) -&gt; args

	Function.<span class="function"><span class="title">argument</span></span> = (n) -&gt; (args...) -&gt; args[n]

	Function.<span class="function"><span class="title">map</span></span> = (mapping) -&gt; (key) -&gt; mapping[key]

	Function.<span class="function"><span class="title">switch</span></span> = (variants=[]) -&gt;
		<span class="function"><span class="title">fn</span></span> = (args...) -&gt;
			<span class="keyword">for</span> variant <span class="keyword">in</span> variants
				<span class="keyword">return</span> variant.apply(<span class="keyword">this</span>,args) <span class="keyword">if</span> variant.test args...
			<span class="keyword">return</span> <span class="literal">undefined</span>
		fn.extend extend: (variants2=[]) -&gt;
			Function.<span class="keyword">switch</span> variants2.concat variants

	window.Type = <span class="function"><span class="title">Type</span></span> = (types...) -&gt;
		(fn) -&gt; fn.extend test: Function.hastypes types...</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2>Function composition</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">then</span></span> = (fn2) -&gt;
		<span class="keyword">throw</span> <span class="string">'Precondition failure'</span> <span class="keyword">unless</span> <span class="keyword">typeof</span> fn2 == <span class="string">'function'</span>
		fn1 = <span class="keyword">this</span>
		(args...) -&gt; fn2.call <span class="keyword">this</span>, fn1.apply(<span class="keyword">this</span>,args)

	Function::<span class="function"><span class="title">but</span></span> = (fn2) -&gt;
		<span class="keyword">throw</span> <span class="string">'Precondition failure'</span> <span class="keyword">unless</span> <span class="keyword">typeof</span> fn2 == <span class="string">'function'</span>
		fn1 = <span class="keyword">this</span>
		(args...) -&gt;
			fn1.apply <span class="keyword">this</span>, args
			fn2.apply <span class="keyword">this</span>, args

	Function.<span class="function"><span class="title">pipe</span></span> = (fn,fns...) -&gt;
		<span class="keyword">throw</span> <span class="string">'Precondition failure'</span> <span class="keyword">unless</span> <span class="keyword">typeof</span> fn <span class="keyword">in</span> [<span class="string">'function'</span>,<span class="string">'undefined'</span>]
		<span class="keyword">switch</span> arguments.length
			<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> fn
			<span class="keyword">when</span> <span class="number">0</span> <span class="keyword">then</span> Function.identity
			<span class="keyword">else</span> fn.<span class="keyword">then</span> Function.pipe fns...

	Function.<span class="function"><span class="title">compose</span></span> = (fn,fns...) -&gt;
		<span class="keyword">throw</span> <span class="string">'Precondition failure'</span> <span class="keyword">unless</span> <span class="keyword">typeof</span> fn <span class="keyword">in</span> [<span class="string">'function'</span>,<span class="string">'undefined'</span>]
		<span class="keyword">switch</span> arguments.length
			<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> fn
			<span class="keyword">when</span> <span class="number">0</span> <span class="keyword">then</span> Function.identity
			<span class="keyword">else</span> Function.pipe (Array.concat arguments...).reverse()...</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h2>Aspect-like methods</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">pre</span></span> = (pre) -&gt;
		<span class="keyword">throw</span> <span class="string">'Precondition failure'</span> <span class="keyword">unless</span> <span class="keyword">typeof</span> pre == <span class="string">'function'</span>
		pre.but <span class="keyword">this</span>

	Function::<span class="function"><span class="title">post</span></span> = (post) -&gt;
		<span class="keyword">throw</span> <span class="string">'Precondition failure'</span> <span class="keyword">unless</span> <span class="keyword">typeof</span> post == <span class="string">'function'</span>
		fn = <span class="keyword">this</span>
		(args...) -&gt;
			ret = fn.apply <span class="keyword">this</span>, args
			post.apply <span class="keyword">this</span>, [ret].concat(args)
			ret</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h2>Preconditions and postconditions</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">matches</span></span> = -&gt; <span class="literal">true</span>

	Function::<span class="function"><span class="title">require</span></span> = (predicate,message=<span class="string">'Precondition failure'</span>) -&gt;
		<span class="property">@pre</span> (args...) -&gt;
			<span class="keyword">throw</span> message+<span class="string">': '</span>+args.toString() <span class="keyword">unless</span> predicate.apply <span class="keyword">this</span>, args

	Function::<span class="function"><span class="title">ensure</span></span> = (predicate,message=<span class="string">'Postcondition failure'</span>) -&gt;
		<span class="property">@post</span> (args...) -&gt;
			<span class="keyword">throw</span> message+<span class="string">': '</span>+args.toString() <span class="keyword">unless</span> predicate.apply <span class="keyword">this</span>, args</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2>Typed functions</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function.<span class="function"><span class="title">hastypes</span></span> = (types...) -&gt;
		predicate = Array.hastypes types...
		(args...) -&gt; predicate args

	Function::<span class="function"><span class="title">Requiring</span></span> = (predicate,message) -&gt;
		<span class="property">@then</span> (fn) -&gt; fn.require predicate, message

	Function.<span class="function"><span class="title">Requiring</span></span> = (predicate,message) -&gt;
		(fn) -&gt; fn.require predicate, message

	Function::<span class="function"><span class="title">Ensuring</span></span> = (predicate,message) -&gt;
		<span class="property">@then</span> (fn) -&gt; fn.ensure predicate, message

	Function.<span class="function"><span class="title">Ensuring</span></span> = (predicate,message) -&gt;
		(fn) -&gt; fn.ensure predicate, message

	Function::<span class="function"><span class="title">From</span></span> = (types...) -&gt;
		matches = Function.hastypes types...
		fn = <span class="property">@Requiring</span> matches, <span class="string">'Incorrect source type. Arguments are'</span>
		fn.matches = matches
		<span class="keyword">return</span> fn

	Function.<span class="function"><span class="title">From</span></span> = (types...) -&gt;
		matches = Function.hastypes types...
		fn = Function.Requiring matches, <span class="string">'Incorrect source type. Arguments are'</span>
		fn.matches = matches
		<span class="keyword">return</span> fn

	Function::<span class="function"><span class="title">To</span></span> = (type) -&gt;
		<span class="property">@Ensuring</span> Object.isa(type), <span class="string">'Incorrect target type. Returned value is'</span>

	Function.<span class="function"><span class="title">To</span></span> = (type) -&gt;
		Function.Ensuring Object.isa(type), <span class="string">'Incorrect target type. Returned value is'</span>

	Function.<span class="function"><span class="title">Of</span></span> = (constructor) -&gt;
		ensure = Object.ensure constructor
		(fn) -&gt; (args...) -&gt; fn.call <span class="keyword">this</span>, ensure args...

	window.Predicate = Function.To Boolean</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h2>Logical functions</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="keyword">and</span> = Function.From(Function) \
		(predicate2) -&gt;
			predicate1 = <span class="keyword">this</span>
			Predicate (args...) -&gt;
				predicate1.apply(<span class="keyword">this</span>,args) <span class="keyword">and</span> predicate2.apply(<span class="keyword">this</span>,args)

	Function::<span class="keyword">or</span> = Function.From(Function) \
		(predicate2) -&gt;
			predicate1 = <span class="keyword">this</span>
			Predicate (args...) -&gt;
				predicate1.apply(<span class="keyword">this</span>,args) <span class="keyword">or</span> predicate2.apply(<span class="keyword">this</span>,args)

	Function::<span class="function"><span class="title">not</span></span> = -&gt;
		predicate = <span class="keyword">this</span>
		Predicate (args...) -&gt; <span class="keyword">not</span> predicate.apply <span class="keyword">this</span>, args

	Function.<span class="keyword">and</span> = Function.From([Function]).To(Function) \
		(predicate,predicates...) -&gt;
			<span class="keyword">switch</span> arguments.length
				<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> predicate
				<span class="keyword">when</span> <span class="number">0</span> <span class="keyword">then</span> -&gt; <span class="literal">true</span>
				<span class="keyword">else</span> predicate.<span class="keyword">and</span> Function.<span class="keyword">and</span> predicates...

	Function.<span class="keyword">or</span> = Function.From([Function]).To(Function) \
		(predicate,predicates...) -&gt;
			<span class="keyword">switch</span> arguments.length
				<span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> predicate
				<span class="keyword">when</span> <span class="number">0</span> <span class="keyword">then</span> -&gt; <span class="literal">false</span>
				<span class="keyword">else</span> predicate.<span class="keyword">or</span> Function.<span class="keyword">or</span> predicates...

	Function.<span class="function"><span class="title">not</span></span> = (predicate) -&gt;
		<span class="keyword">if</span> <span class="keyword">typeof</span> predicate == <span class="string">'function'</span> <span class="keyword">then</span> predicate.<span class="keyword">not</span>() <span class="keyword">else</span> <span class="keyword">not</span> predicate</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2>Return value manipulation</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function.<span class="function"><span class="title">Returning</span></span> = (val) -&gt;
		(fn) -&gt; (args...) -&gt;
			ret = val.call(<span class="keyword">this</span>)
			fn.call(<span class="keyword">this</span>,ret).apply(<span class="keyword">this</span>,args)
			<span class="keyword">return</span> ret

	Function::<span class="function"><span class="title">Returning</span></span> = (val) -&gt;
		Function.Returning(val).<span class="keyword">then</span>(<span class="keyword">this</span>)

	Function.<span class="function"><span class="title">Constant</span></span> = (constant) -&gt; (fn) -&gt; fn.but -&gt; constant

	Function.Chaining = Function.From(Function) (fn) -&gt; fn.but -&gt; <span class="keyword">this</span>

	Function::Chaining = Function.From(Function) (fn) -&gt; @(fn).but -&gt; <span class="keyword">this</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2>Delegation</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function.<span class="function"><span class="title">delegate</span></span> = (fn) -&gt;
		(args...) -&gt; 
			[context,method] = fn.call(<span class="keyword">this</span>)
			method.apply context, args

	Function.<span class="function"><span class="title">delegates</span></span> = (fn) -&gt;
		<span class="keyword">for</span> index <span class="keyword">in</span> [<span class="number">0.</span><span class="number">.9</span>]
			<span class="keyword">do</span> (index) -&gt; (args...) -&gt;
				[context,fns...] = fn.call(<span class="keyword">this</span>)
				fns[index].apply context, args</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <h2>Composite ordering</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function.ordering = Function.<span class="keyword">or</span></pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2>Predicates</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function.<span class="function"><span class="title">eq</span></span>  = (value) -&gt; Predicate (x) -&gt; x == value
	Function::<span class="function"><span class="title">eq</span></span> = (value) -&gt; <span class="property">@then</span> Function.eq value

	Function.<span class="function"><span class="title">neq</span></span>  = (value) -&gt; Predicate (x) -&gt; x != value
	Function::<span class="function"><span class="title">neq</span></span> = (value) -&gt; <span class="property">@then</span> Function.neq value

	Function.<span class="function"><span class="title">lt</span></span>  = (value) -&gt; Predicate (x) -&gt; x &lt; value
	Function::<span class="function"><span class="title">lt</span></span> = (value) -&gt; <span class="property">@then</span> Function.lt value

	Function.<span class="function"><span class="title">gt</span></span>  = (value) -&gt; Predicate (x) -&gt; x &gt; value
	Function::<span class="function"><span class="title">gt</span></span> = (value) -&gt; <span class="property">@then</span> Function.gt value

	Function.<span class="function"><span class="title">lte</span></span>  = (value) -&gt; Predicate (x) -&gt; x &lt;= value
	Function::<span class="function"><span class="title">lte</span></span> = (value) -&gt; <span class="property">@then</span> Function.lte value

	Function.<span class="function"><span class="title">gte</span></span>  = (value) -&gt; Predicate (x) -&gt; x &gt;= value
	Function::<span class="function"><span class="title">gte</span></span> = (value) -&gt; <span class="property">@then</span> Function.gte value

	<span class="function"><span class="title">ordered</span></span> = (lower,higher) -&gt; lower &lt;= higher

	Function.<span class="function"><span class="title">between</span></span> = ( Function.Requiring ordered ) (lower,higher) -&gt;
		Predicate (x) -&gt; lower &lt;= x &lt;= higher

	Function::<span class="function"><span class="title">between</span></span> = (lower,higher) -&gt; <span class="property">@then</span> Function.between lower,higher

	Function::<span class="keyword">is</span> = Function::<span class="keyword">then</span>

	Function::<span class="function"><span class="title">matches</span></span> = (regex) -&gt; <span class="property">@then</span> Predicate (x) -&gt; regex.test x

	Function::<span class="function"><span class="title">isnull</span></span> = -&gt; <span class="property">@then</span> Function.eq <span class="literal">null</span>

	Function::<span class="function"><span class="title">isa</span></span> = (constructor) -&gt; <span class="property">@then</span> Predicate (x) -&gt; x <span class="keyword">instanceof</span> constructor

	Function::<span class="function"><span class="title">hastype</span></span> = (type) -&gt; <span class="property">@then</span> Object.type.eq type

	Function::<span class="function"><span class="title">inherits</span></span> = (constructor) -&gt; <span class="property">@prototype</span> <span class="keyword">instanceof</span> constructor</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2>Application methods</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">bind</span></span> = (context,args1...) -&gt;
		fn = <span class="keyword">this</span>
		(args2...) -&gt; fn.apply context, Array.concat(args1,args2)

	Function::<span class="function"><span class="title">curry</span></span> = (args1...) -&gt;
		fn = <span class="keyword">this</span>
		(args2...) -&gt; fn.apply <span class="keyword">this</span>, Array.concat(args1,args2)

	Function::<span class="function"><span class="title">except</span></span> = (handler) -&gt;
		fn = <span class="keyword">this</span>
		(args...) -&gt;
			<span class="keyword">try</span> fn.apply <span class="keyword">this</span>, args
			<span class="keyword">catch</span> error
				handler.call <span class="keyword">this</span>, error

	Function::<span class="function"><span class="title">memo</span></span> = -&gt;
		cache = {}
		fn = <span class="property">@post</span> (ret,args...) -&gt; cache[args] = ret
		(args...) -&gt; cache[args] ? fn.apply <span class="keyword">this</span>, arguments

	Function::delay ?= (duration=<span class="number">1</span>,args1...) -&gt;
		fn = <span class="keyword">this</span>
		(args2...) -&gt; setTimeout fn.curry.apply(fn,Array.concat(args1,args2)), duration</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h2>Mapping methods</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">map</span></span> = (mapping) -&gt; <span class="property">@then</span> Function.map mapping</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2>Ordering methods</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">asc</span></span> = -&gt;
		fn = <span class="keyword">this</span>
		(a,b) -&gt;
			fna = fn.call <span class="keyword">this</span>, a
			fnb = fn.call <span class="keyword">this</span>, b
			<span class="keyword">return</span> -<span class="number">1</span> <span class="keyword">if</span> fna &lt; fnb
			<span class="keyword">return</span>  <span class="number">1</span> <span class="keyword">if</span> fna &gt; fnb
			<span class="keyword">return</span>  <span class="number">0</span>

	Function::<span class="function"><span class="title">desc</span></span> = -&gt; <span class="property">@asc</span>().<span class="keyword">then</span> (x) -&gt; -x</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2>Constructor methods</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">create</span></span> = (args...) -&gt; Object.construct(<span class="keyword">this</span>)(args...)</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <h2>Restricted types</h2>
<p>NOTE: Make this work with objects other than strings and numbers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>	Function::<span class="function"><span class="title">Where</span></span> = (predicate,message=<span class="string">'Invalid value'</span>) -&gt;
		restricted = <span class="property">@post</span> (value) -&gt; <span class="keyword">throw</span> message.replace(<span class="string">'&lt;value&gt;'</span>,value) <span class="keyword">unless</span> predicate value
		restricted.base = <span class="property">@base</span> <span class="keyword">or</span> <span class="keyword">this</span>
		restricted[property] = value <span class="keyword">for</span> property, value <span class="keyword">of</span> restricted.base
		restricted.valid = Object.isa(restricted.base).<span class="keyword">and</span> predicate
		<span class="keyword">return</span> restricted</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
